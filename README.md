The accompanying spreadsheet (currently distributed with the name “SPF Tool 3.5.xlsm” and hereafter called “the spreadsheet”, “the tool” or “the program”) is intended to fit parametric Safety Performance Functions to collision data.  It is authored by Matt Warren, P.E., and is available free for use by qualified traffic safety analysts.  Permission is granted to use, copy, and distribute both the spreadsheet and this user manual, provided that neither is altered from its original form except for changes of formatting and changes to the spreadsheet that naturally occur in the course of use, that no claims of authorship are made, that programmatic notices conveying this information are not altered, removed, or disabled, and that distribution of any copies, with or without variation, is free of charge and free of any stipulation or encumbrance except as given herein.  The spreadsheet is supplied “as-is” and without any warranty or guarantee, express or implied.  Persons unfamiliar with the nature and use of Safety Performance Functions should not use this spreadsheet.  It is intended only for the use of traffic safety professionals.

The author assumes no duty to support this spreadsheet or to assist users in any way, including correction of critical errors or security flaws or providing relevant information.  All users of this spreadsheet assume full responsibility for any and all direct or indirect outcomes of that use, including but not limited to costs, damages, or burdens therefrom arising.  The author does not guarantee that this manual is free from error or that future changes to the spreadsheet will be reflected herein.

1.1	System Requirements:  The spreadsheet has been tested with Excel 2010 and 2016 and may not be compatible with other versions of Excel.  It is definitely not compatible with any version of Excel prior to Excel 2007.  The Solver plug-in is required.  The spreadsheet will not function with any operating system other than MS Windows, even if that operating system supports Excel.  The spreadsheet uses macros and will not work unless macros are enabled.  The Excel Solver must be installed before the spreadsheet is opened or it will not work (see 2.0).

1.2	Contact:  Bug reports or requests for information may be sent to Matt Warren at matt.warren.oklahoma@gmail.com.  Responses are not guaranteed.  Please consult this manual, especially Part 5, before sending a bug report.  When sending a report, please include a copy of the spreadsheet saved at the point of failure if possible.  Bug fixes or upgrades might be sent to users who have requested them.

1.3	Advantages:  This program is primarily a wrapper for the Excel Solver.  Advantages over using the Solver alone include:
•	Automation of various operations, such as the addition of parameters to functions and the creation of a variety of graphs.
•	Quick access to graphical information about the fit of a model, with residuals plotted in various ways against any available variables and controllable smoothing of the graphs.
•	Improved solutions.  The Excel Solver does not work well for large data sets and equations with multiple parameters, because the gradient of the optimization function can be extremely small, leading to premature halting and poor solutions.  This program can force the Solver to find solutions closer to the true optimum.
•	Functional parameters and independent variables are automatically and transparently scaled.  The Solver’s own scaling algorithms, as of Excel 2010, are generally ineffective, also leading to premature halting and poor solutions.
•	Parameters may be constrained to the interval (0,∞), an option not available in the Solver as of Excel 2010.
•	Initial guesses for parameter values are made automatically.
•	Quick switching between alternative solution optimization methods and constraints.
•	Several measures of performance are calculated automatically, including cumulative residual plots.

1.4	Limitations:  Use of the spreadsheet requires a data set including a column of crash counts and at least one column of roadway data, with one row per site.  This data must be prepared externally in some form which is capable of being copied into an Excel spreadsheet.  The data may not exceed 65,535 rows plus one row for column headers, and may not exceed 98 columns of roadway data plus one column of crash data and one column for site identification.

1.5	Assumptions:  The model assumes a negative binomial distribution of crash counts.  It does not make any assumptions about the functional form of crash prediction models or about the form in which overdispersion is expressed.

1.6	Cautions:  The spreadsheet is supplied “as-is” and without any warranty or guarantee, express or implied.  The author assumes no obligation to provide support of any kind.  The spreadsheet has limited data screening functions but cannot assure that data provided are accurate, meaningful, or negative binomially distributed.  Solutions which are reached could be local optimums but not global optimums; solutions may also not be optimums at all due to premature halting of the Solver (see 4.5.5).  The acceptability of a solution for practical use must depend on the judgment of a person with knowledge of traffic accident data analysis.

The spreadsheet is intended for use by persons familiar with Excel and having knowledge of the basics of Empirical Bayesian traffic accident data analysis and the use of Safety Performance Functions (as outlined in the Highway Safety Manual).  The spreadsheet is not a substitute for this knowledge.
  
Users should not make changes to any of the hidden worksheets in the spreadsheet, nor to any cells except those designated for user input, nor to any chart.  Minor formatting changes such as column width and cell color may be made but could be automatically reversed by the operation of macros.  Any other changes should only be made with caution by an expert Excel user familiar with the spreadsheet.  Changes for example to charts, to the number format of cells, to sheet protection, or to the merging of cells, could result in failure of the spreadsheet.  Worksheets may not be renamed but new worksheets may be added.  Deletion or renaming of user-added sheets is permissible but deletion or renaming of any other sheet, or changes to hidden sheets, is likely to result in irreversible failure of the spreadsheet.  Cut-and-Paste or Drag-and-Drop operations should NEVER be performed except in the Data worksheet.

The spreadsheet currently does not use sheet protections.  Anyone with access to the spreadsheet must be familiar with Excel and also with these cautions; otherwise irreparable corruption of the spreadsheet is likely.

“Undo” will generally not be available within the spreadsheet, due to irreversible macro operations which occur on all button clicks and also on most changes to cells in the “Model” worksheet.  External copies of the data used should be retained; if the data is accidentally cleared from the spreadsheet it might not be recoverable.
  
Always keep a backup copy of the original spreadsheet as you received it.
